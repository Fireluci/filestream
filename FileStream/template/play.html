<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ”†å½¡âŸ¨ HEROFLiX âŸ©å½¡ðŸ”†</title>

<link rel="icon" href="https://i.ibb.co/vxJD4dHK/0e76d1ae7331ca3964dd169b8b5c2f10.jpg" type="image/x-icon">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/proavipatil/data@main/fs/src/plyr.css">

<style>
body {
    background: #0d0d0d;
    color: white;
    font-family: 'Josefin Sans', sans-serif;
    user-select: none;
}
nav { padding: 15px 10px; text-align: center; }
nav h3 { font-size: 26px; font-weight: 700; color: #ffcc00; }

/* Filename */
.file-name { text-align: center; margin-top: 20px; font-weight: 600; font-size: 15px; }

/* Responsive Play Button */
#playOverlay img {
    width: 20vw;
    max-width: 130px;
    min-width: 60px;
    filter: drop-shadow(0 0 6px #000);
}

/* Fade Controls */
.left-skip, .right-skip, #playOverlay {
    opacity: 1;
    transition: opacity .35s ease;
    pointer-events: auto;
}
.hide-controls {
    opacity: 0;
    pointer-events: none;
}

/* Skip Buttons */
.skip-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    padding: 10px;
    user-select: none;
}
.left-skip { left: 20%; }
.right-skip { right: 20%; }

/* Ripple Effect */
.ripple {
  position: absolute;
  width: 140px;
  height: 140px;
  border-radius: 50%;
  background: rgba(255,255,255,0.3);
  transform: scale(0);
  animation: ripple-anim .4s ease-out forwards;
  pointer-events: none;
}
@keyframes ripple-anim {
  to { transform: scale(1.8); opacity: 0; }
}
</style>
</head>

<body>

<nav><h3>ðŸ”†å½¡âŸ¨ HEROFLiX âŸ©å½¡ðŸ”†</h3></nav>

<div style="width:100%; max-width:900px; margin:auto;">

<!-- VIDEO -->
<div style="position: relative;">
    <video id="player" class="player"
        src="{{file_url}}" type="video/mp4"
        playsinline controls width="100%"></video>

    <!-- PLAY BUTTON -->
    <div id="playOverlay" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); cursor:pointer;">
        <img src="https://i.ibb.co/hFsmpbvd/play.png">
    </div>

    <!-- BACK 10s -->
    <div class="skip-btn left-skip" onclick="skipBack()">
        <img src="https://i.ibb.co/S70cgrW5/backward.png" width="50">
    </div>

    <!-- FORWARD 10s -->
    <div class="skip-btn right-skip" onclick="skipForward()">
        <img src="https://i.ibb.co/N252Lk5Y/forward.png" width="50">
    </div>
</div>

<div class="file-name">[{{file_size}}] <span id="cleanName"></span></div>

<!-- BUTTONS -->
<div class="downloadBtn" style="display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:25px;">
    <button onclick="streamDownload()"><img style="height:22px;" src="https://i.ibb.co/D6CnBqs/download.png"> Download</button>
    <button onclick="copyStreamLink()"><img style="height:22px;" src="https://i.ibb.co/RTH4vkB5/copy-link.png"> Copy Link</button>
    <button onclick="vlc_player()"><img style="height:22px;" src="https://i.ibb.co/px6fQs1/vlc.png"> VLC Player</button>
    <button onclick="mx_player()"><img style="height:22px;" src="https://i.ibb.co/41WvtQ3/mx.png"> MX Player</button>
    <button onclick="n_player()"><img style="height:22px;" src="https://i.ibb.co/Hd2dS4t/nPlayer.png"> nPlayer</button>
</div>

</div>

<script>
const video=document.getElementById("player");
const overlay=document.getElementById("playOverlay");

let controlsVisible=true, controlsTimeout;

/* CLEAN FILENAME (remove @name, keep dash) */
function cleanFileName(name) {
    return name.replace(/^@[A-Za-z0-9_]+[.\-\s]?/, "");
}
document.getElementById("cleanName").innerText = cleanFileName("{{file_name}}");

/* Skip */
function skipBack(){ video.currentTime -= 10; }
function skipForward(){ video.currentTime += 10; }

/* DOWNLOAD */
function streamDownload(){
    let url = window.location.href.replace("/watch/", "/dl/").replace("/view/", "/dl/");
    alert("â¬‡ï¸ Download Started!");
    window.location.href = url;
}

/* COPY */
function copyStreamLink(){
    navigator.clipboard.writeText(window.location.href);
    alert("ðŸ”— Link Copied!");
}

/* SHOW CONTROLS */
function showControls() {
    controlsVisible = true;
    overlay.classList.remove("hide-controls");
    document.querySelector('.left-skip').classList.remove("hide-controls");
    document.querySelector('.right-skip').classList.remove("hide-controls");
    clearTimeout(controlsTimeout);
    if (!video.paused) controlsTimeout = setTimeout(hideControls, 5000);
}

/* HIDE CONTROLS */
function hideControls() {
    if (!video.paused) controlsVisible=false, overlay.classList.add("hide-controls");
    document.querySelector('.left-skip').classList.add("hide-controls");
    document.querySelector('.right-skip').classList.add("hide-controls");
}

/* TAP BEHAVIOR */
function screenTap() {
    if (!controlsVisible) return showControls();
    video.paused ? video.play() : video.pause();
    showControls();
}
video.addEventListener("click", screenTap);
video.addEventListener("touchstart", screenTap);
overlay.addEventListener("click", e => { e.stopPropagation(); screenTap(); });

/* Movement shows controls */
["mousemove","touchmove","pause","play"].forEach(e => video.addEventListener(e,showControls));

/* DOUBLE TAP SKIP */
let lastTap=0;
function handleTap(e){
    let now=Date.now();
    if(now-lastTap<300){
        let x=(e.touches?e.touches[0].clientX:e.clientX);
        x<window.innerWidth/2? skipAnim("left") : skipAnim("right");
    }
    lastTap=now;
}
function skipAnim(side){
    side==="left"? video.currentTime-=10 : video.currentTime+=10;
    createRipple(side);
}
function createRipple(side){
    let div=document.createElement("div");
    div.className="ripple";
    div.style.left=side==="left"?"20%":"70%";
    div.style.top="50%";
    document.body.appendChild(div);
    setTimeout(()=>div.remove(),400);
}
video.addEventListener("touchstart",handleTap);
video.addEventListener("click",handleTap);

/* MOBILE/PC CHECK */
function isMobile(){ return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent); }

/* EXTERNAL PLAYERS */
function mx_player(){
    if(!isMobile()){ alert("â¬‡ï¸ MX not supported on PC, downloading..."); window.open("{{file_url}}","_blank"); return; }
    window.location.href=`intent:{{file_url}}#Intent;scheme=https;type=video/*;S.title={{file_name}};package=com.mxtech.videoplayer.ad;end`;
    setTimeout(()=>window.location.href="market://details?id=com.mxtech.videoplayer.ad",800);
    setTimeout(()=>window.location.href="https://play.google.com/store/apps/details?id=com.mxtech.videoplayer.ad",1600);
}
function vlc_player(){
    if(!isMobile()){ window.location.href=`vlc://{{file_url}}`; setTimeout(()=>window.open("{{file_url}}","_blank"),1000); return; }
    window.location.href=`vlc://{{file_url}}`;
    setTimeout(()=>window.location.href="market://details?id=org.videolan.vlc",800);
    setTimeout(()=>window.location.href="https://play.google.com/store/apps/details?id=org.videolan.vlc",1600);
}
function n_player(){
    if(!isMobile()){ alert("âŒ nPlayer not on PC. Downloading..."); window.open("{{file_url}}","_blank"); return; }
    window.location.href=`nplayer-{{file_url}}`;
    setTimeout(()=>window.location.href="market://details?id=com.newin.nplayer",800);
    setTimeout(()=>window.location.href="https://play.google.com/store/apps/details?id=com.newin.nplayer",1600);
}
</script>

<script src="https://cdn.plyr.io/3.6.9/plyr.js"></script>
</body>
</html>
