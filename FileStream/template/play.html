<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîÜÂΩ°‚ü® HEROFLiX ‚ü©ÂΩ°üîÜ</title>

<link rel="icon" href="https://i.ibb.co/vxJD4dHK/0e76d1ae7331ca3964dd169b8b5c2f10.jpg" type="image/x-icon">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
    margin: 0;
    font-family: 'Josefin Sans', sans-serif;
    color: white;
    user-select: none;
}

/* üî• BLURRED BACKGROUND IMAGE */
body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: url('https://i.ibb.co/qMqgBPDY/e44bf8ca9423beeda43aa3367cfb878a.jpg') center/cover no-repeat;
    filter: blur(28px) brightness(0.32);
    transform: scale(1.15);
    z-index: -1;
}

nav { padding: 15px 10px; text-align: center; }
nav h3 { font-size: 26px; font-weight: 700; color: #ffcc00; }

.file-name { text-align: center; margin-top: 20px; font-weight: 600; font-size: 15px; }

/* Skip buttons */
.skip-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    padding: 10px;
    user-select: none;
}

.left-skip { left: 10%; }
.right-skip { right: 10%; }

.hide-controls {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.35s ease;
}

.left-skip, .right-skip {
    transition: opacity 0.35s ease;
}

/* Buttons Below Player */
.downloadBtn button {
    background: #222;
    border: 1px solid #444;
    padding: 10px 15px;
    border-radius: 8px;
    font-size: 13px;
    color: #fff;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 7px;
    cursor: pointer;
}
.downloadBtn button:hover {
    background: #ffcc00;
    color: #000;
    border-color: #ffcc00;
}
</style>
</head>

<body>

<nav><h3>üîÜÂΩ°‚ü® HEROFLiX ‚ü©ÂΩ°üîÜ</h3></nav>

<div style="width:100%; max-width:900px; margin:auto;">

<!-- VIDEO PLAYER -->
<div style="position: relative;">

    <video id="player"
        src="{{file_url}}"
        playsinline
        controls
        width="100%">
    </video>

    <!-- BACK 10s -->
    <div class="skip-btn left-skip" onclick="skipBack()">
        <img src="https://i.ibb.co/S70cgrW5/backward.png" width="55">
    </div>

    <!-- FORWARD 10s -->
    <div class="skip-btn right-skip" onclick="skipForward()">
        <img src="https://i.ibb.co/N252Lk5Y/forward.png" width="55">
    </div>

</div>

<div class="file-name">[{{file_size}}] <span id="cleanName"></span></div>

<!-- ACTION BUTTONS -->
<div class="downloadBtn"
     style="display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:25px;">
    <button onclick="streamDownload()">
        <img style="height:22px;" src="https://i.ibb.co/D6CnBqs/download.png"> Download
    </button>
    <button onclick="copyStreamLink()">
        <img style="height:22px;" src="https://i.ibb.co/RTH4vkB5/copy-link.png"> Copy Link
    </button>
    <button onclick="vlc_player()">
        <img style="height:22px;" src="https://i.ibb.co/px6fQs1/vlc.png"> VLC Player
    </button>
    <button onclick="mx_player()">
        <img style="height:22px;" src="https://i.ibb.co/41WvtQ3/mx.png"> MX Player
    </button>
</div>

</div>

<script>
const video = document.getElementById("player");
const leftSkip = document.querySelector(".left-skip");
const rightSkip = document.querySelector(".right-skip");
let hideTimeout;

/* ‚≠ê FINAL CLEAN FILE NAME FUNCTION */
function cleanFileName(name) {
    if (!name) return "Unknown File";

    name = name.trim();

    // 1. Remove everything after video extension
    name = name.replace(/(\.(mkv|mp4|avi|mov|wmv|flv)).*$/i, "$1");

    // 2. Remove @Channel -   or   @Channel - -
    name = name.replace(/^@[\w_]+(\s*-\s*)*/i, "").trim();

    // 3. Remove @Channel-FileName
    name = name.replace(/^@[\w_]+-/, "").trim();

    // 4. Remove emojis / weird symbols from start
    name = name.replace(/^[^\w(]+/, "").trim();

    // 5. Fix duplicate filenames joined accidentally
    if (name.toLowerCase().includes(".mkv"))
        name = name.split(/\.mkv/i)[0] + ".mkv";

    if (name.toLowerCase().includes(".mp4"))
        name = name.split(/\.mp4/i)[0] + ".mp4";

    return name.trim();
}

document.getElementById("cleanName").innerText = cleanFileName("{{file_name}}");

/* --- 10-second skip functions --- */
function skipBack() {
    video.currentTime = Math.max(0, video.currentTime - 10);
    showControls();
}
function skipForward() {
    video.currentTime = Math.min(video.duration, video.currentTime + 10);
    showControls();
}

/* --- Show controls --- */
function showControls() {
    leftSkip.classList.remove("hide-controls");
    rightSkip.classList.remove("hide-controls");

    clearTimeout(hideTimeout);
    if (!video.paused)
        hideTimeout = setTimeout(hideControls, 5000);
}

/* --- Hide controls --- */
function hideControls() {
    if (video.paused) return;
    leftSkip.classList.add("hide-controls");
    rightSkip.classList.add("hide-controls");
}

/* --- Events --- */
video.addEventListener("mousemove", showControls);
video.addEventListener("touchstart", showControls);
video.addEventListener("click", showControls);

video.addEventListener("play", () => showControls());
video.addEventListener("pause", () => {
    leftSkip.classList.remove("hide-controls");
    rightSkip.classList.remove("hide-controls");
});

/* DOWNLOAD + COPY */
function streamDownload(){
    let url = window.location.href.replace("/watch/", "/dl/").replace("/view/", "/dl/");
    alert("‚¨áÔ∏è Download Starting!"); 
    window.location.href = url;
}
function copyStreamLink(){
    navigator.clipboard.writeText(window.location.href);
    alert("üîó Link Copied!");
}

/* MX & VLC */
function mx_player(){
    var url = "{{file_url}}";
    window.location.href =
    `intent:${encodeURIComponent(url)}#Intent;action=android.intent.action.VIEW;type=video/*;package=com.mxtech.videoplayer.ad;S.title=${encodeURIComponent("{{file_name}}")};end`;
}
function vlc_player(){
    var url = "{{file_url}}";
    window.location.href =
    `intent:${encodeURIComponent(url)}#Intent;action=android.intent.action.VIEW;type=video/*;package=org.videolan.vlc;S.title=${encodeURIComponent("{{file_name}}")};end`;
}
</script>

</body>
</html>
